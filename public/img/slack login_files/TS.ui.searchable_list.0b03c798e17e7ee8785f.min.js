(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[119],{2501:function(e,t){(function(){TS.registerModule("ui.searchable_list",{onStart:function e(){TS.ui.searchable_list.search_update=new signals.Signal},build:function e(r,s){n=[];a=$("#searchable_list_rows");i=true;r.forEach(function(e){TS.ui.searchable_list.push(e,s)});t=$("#searchable_list_search_input");t.length>0&&c();d()},push:function t(r,n){if(!i)return TS.error(e.replace("%METHOD%","push"));var o=s(r,n);a.append(o);return o},unshift:function t(r,n){if(!i)return TS.error(e.replace("%METHOD%","unshift"));var o=s(r,n);a.prepend(o);return o},search:function a(n){if(!i)return TS.error(e.replace("%METHOD%","search"));n.length?r.removeClass("hidden"):r.addClass("hidden");t.val(n);t.focus();return f(n.trim())},getSearchTerm:function r(){if(!i)return TS.error(e);var a=t.val()||"";return a.trim()},destroy:function e(){t&&t.off("input",u);r&&r.off("click",h)}});var e="TS.ui.searchable_list.build must be called before TS.ui.searchable_list.%METHOD% can be called";var t;var r;var a;var n;var i;var s=function e(t,r){var a=n.length;t.id=t.id||"searchable_list_row_"+a;var i=r(t);var s=$(i);var l=o(s);n.push({has_matches:false,$el:s,elements:l.elements,original_text:l.text,searchable_text:l.text.join(" ")});return s};var o=function e(t){var r=[];var a=[];l(t,r,a);return{elements:r,text:a}};var l=function e(t,r,a){t.contents().each(function(){if(this.nodeType===Node.TEXT_NODE&&""!==this.textContent.replace(/\s|\n/g,"")){r.push(this.parentElement);a.push(this.textContent)}else e($(this),r,a)})};var c=function e(){r=$("#searchable_list_clear_btn");t.on("input",u);r.on("click",h)};var u=function e(){var a=t.val();f(a.trim());a.length?r.removeClass("hidden"):r.addClass("hidden")};var h=function e(){r.addClass("hidden");TS.ui.searchable_list.search("");t.focus()};var p=function e(t){return'<span class="clear_blue">'+t+"</span>"};var f=function e(t){var r;var a;var i;var s;var o=[];if(""===t){n.forEach(function(e){e.$el.removeClass("hidden");e.has_matches&&e.elements.forEach(function(t,r){t.innerHTML=e.original_text[r]})});TS.ui.searchable_list.search_update.dispatch(t,[]);return[]}t=t.trim();r=t.replace(/\s+/g,"|");a="(?=.*"+t.replace(/\s+/g,")(?=.*")+").*";n.forEach(function(e){i=new RegExp(a,"i");s=null!==e.searchable_text.match(i);e.$el.toggleClass("hidden",!s);if(s){i=new RegExp(r,"gi");e.elements.forEach(function(t,r){t.innerHTML=e.original_text[r].replace(i,p)});o.push(e.$el)}else e.has_matches&&e.elements.forEach(function(t,r){t.innerHTML=e.original_text[r]});e.has_matches=s});TS.ui.searchable_list.search_update.dispatch(t,o);return o};var d=function e(){t.on("keydown",function(e){switch(e.keyCode){case TS.utility.keymap.down:e.preventDefault();e.stopPropagation();v(0);break;case TS.utility.keymap.up:e.preventDefault();e.stopPropagation();v(-1);break;default:break}});a.on("keydown",function(e){switch(e.keyCode){case TS.utility.keymap.down:e.preventDefault();e.stopPropagation();_(e.target,"down");break;case TS.utility.keymap.up:e.preventDefault();e.stopPropagation();_(e.target,"up");break;case TS.utility.keymap.enter:e.preventDefault();e.stopPropagation();$(e.target).trigger("click");break;default:break}})};var v=function e(t){var r=a.children();t=-1===t?r.length-1:t;var n=a.children().get(t);if(!n)return TS.error("Could not find row at index:",t);n.focus()};var _=function e(t,r){if("up"!==r&&"down"!==r)return TS.error("Direction must be either 'up' or 'down'.");var n=$(t);n.is("input")&&(n=n.parent());var i=a.children();var s=i.index(n);var o;o="down"===r?s===i.length-1?0:s+1:0===s?-1:s-1;v(o)}})()}},[[2501,0]]]);